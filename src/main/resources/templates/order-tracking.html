<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Tracking | E-Commerce</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {font-family: Arial, sans-serif;background:#f5f5f5;margin:0;padding:0;}
    header {background:#2b2d42;color:#fff;text-align:center;padding:15px 0;}
    .tracking-container {
      max-width:800px;margin:40px auto;background:#fff;padding:30px;
      border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.1);
    }
    h2 {color:#2b2d42;text-align:center;}
    p {text-align:center;color:#555;}
    .progressbar {
      display:flex;justify-content:space-between;position:relative;
      margin:40px 0 30px;
    }
    .progressbar::before {
      content:'';position:absolute;top:50%;left:0;width:100%;height:4px;
      background:#ccc;transform:translateY(-50%);z-index:0;
    }
    .step {
      background:#ccc;color:#fff;width:35px;height:35px;line-height:35px;
      border-radius:50%;text-align:center;z-index:1;position:relative;
    }
    .step.active {background:#2b2d42;}
    .labels {display:flex;justify-content:space-between;font-weight:bold;color:#2b2d42;}
    .info {text-align:center;margin-top:20px;}
    button {
      background:#ef233c;color:white;border:none;padding:10px 20px;
      border-radius:5px;cursor:pointer;transition:0.3s;margin-top:20px;
    }
    button:hover {background:#d90429;}
  </style>
</head>
<body>
  <div th:replace="~{fragments/navbar :: navbar}"></div>

<header>
  <h1>Track Your Order</h1>
</header>

<div class="tracking-container" th:if="${order != null}">
  <h2>Order ID: #<span th:text="${order.id}">0</span></h2>
  <p>Order Date: <strong th:text="${#temporals.format(order.createdAt, 'MMM dd, yyyy')}">Oct 30, 2025</strong></p>

  <div class="progressbar">
    <div class="step" th:classappend="${order.status.name() == 'PENDING' || order.status.name() == 'PROCESSING' || order.status.name() == 'SHIPPED' || order.status.name() == 'DELIVERED' ? 'active' : ''}">1</div>
    <div class="step" th:classappend="${order.status.name() == 'PROCESSING' || order.status.name() == 'SHIPPED' || order.status.name() == 'DELIVERED' ? 'active' : ''}">2</div>
    <div class="step" th:classappend="${order.status.name() == 'SHIPPED' || order.status.name() == 'DELIVERED' ? 'active' : ''}">3</div>
    <div class="step" th:classappend="${order.status.name() == 'DELIVERED' ? 'active' : ''}">4</div>
  </div>

  <div class="labels">
    <span>Ordered</span>
    <span>Processing</span>
    <span>Shipped</span>
    <span>Delivered</span>
  </div>

  <div class="info">
    <p>Your order is <strong th:text="${order.status}">PENDING</strong>.</p>
    <p>Total Amount: <strong th:text="${'₹' + #numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 2, 'POINT')}">₹0.00</strong></p>
    <button onclick="window.location.href='/orders'">View Order History</button>
  </div>
</div>

<div class="tracking-container" th:if="${order == null}">
  <div class="alert alert-warning text-center">
    <i class="fas fa-exclamation-triangle"></i>
    Order not found or you don't have permission to view this order.
  </div>
  <div class="text-center">
    <button onclick="window.location.href='/orders'">View Order History</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
